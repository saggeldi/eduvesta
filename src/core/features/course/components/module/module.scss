@use "theme/globals" as *;

:host {
    --horizontal-spacing: var(--mdl-spacing-4);
    --vertical-spacing: var(--mdl-spacing-2);
    --colored-box-padding: var(--mdl-spacing-2);
    --card-border-width: 0px;
    --card-radius: 0px;
    --card-background: transparent;
    --activity-border: 1px solid var(--stroke);
    --card-padding-bottom: var(--vertical-spacing);

    &:last-child {
        --activity-border: 0px;
        --card-padding-bottom: 0px;
    }

    // --- Modern Activity Card Styling ---
    ion-card {
        margin: 12px 16px !important; // Consistent spacing
        padding: 0px;
        --ion-card-border-width: 0;
        --ion-card-radius: 16px;
        --ion-card-background: white !important;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05) !important;
        border-bottom: 0 !important; // Remove old border
        overflow: visible; // Allow shadows/badges to pop if needed
    }

    // Button Styling (Mark as done, etc)
    ion-button {
        --border-radius: 20px;
        --box-shadow: none;
        font-weight: 600;
        text-transform: none;

        &.button-outline {
             --border-color: #d1d5db;
             --color: #374151;
             --border-width: 1.5px;
        }
    }

    .activity-main {
        --min-height: 64px; // Taller touch target
        display: flex;
        flex-direction: row;
        padding: 12px 8px;

        // Activity Icon container
        core-mod-icon {
            --module-icon-padding: 0px;
            --module-legacy-icon-padding: 4px;
            --module-icon-radius: 8px;
            @include margin-horizontal(8px, 12px);
            align-self: center; // Center vertically

            img {
                 width: 32px;
                 height: 32px;
            }
        }

        .activity-title {
            flex-grow: 1;
            align-self: center;
            @include margin-horizontal(null, var(--horizontal-spacing));

            .item-heading {
                font-size: 15px; // Reduced from potentially large defaults
                font-weight: 600;
                color: #1f2937;
                line-height: 1.4;

                ion-icon {
                    @include margin-horizontal(8px, null);
                    vertical-align: middle;
                    color: #6b7280;
                    font-size: 14px;
                }
            }
        }

        .core-module-buttons {
            align-self: center;
            display: flex;
            flex-flow: row;
            align-items: center;
            z-index: 1;
            justify-content: flex-end;

            // "More" dots button
            ion-button.core-module-button-more {
                cursor: pointer;
                margin: 0px 4px;
                --color: #9ca3af;
                width: 32px;
                height: 32px;

                ion-icon { font-size: 20px; }
            }

            core-course-module-completion {
                --margin: 0px;
                margin-right: 8px;
                // Style the completion checkmark/button if feasible here
            }
        }

        core-mod-icon,
        .activity-title,
        .core-module-buttons {
            margin-top: 0; // Reset margins handled by padding
            margin-bottom: 0;
        }
    }

    .core-module-description ::ng-deep img,
    .activity-title .item-heading core-format-text ::ng-deep img {
        border-radius: var(--mdl-shape-borderRadius-lg);
    }

    core-course-module-completion {
        --margin: var(--vertical-spacing) 0px;
    }

    .activity-dates {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;

        core-reminders-date {
          --display-icon: none;
        }
    }

    .activity-description-availabilityinfo,
    .activity-extrabadges {
        margin-top: var(--vertical-spacing);
        margin-bottom: var(--vertical-spacing);
    }

    .core-module-description {
        display: block;
    }

    .activity-extrabadges {
        font: var(--mdl-typography-body-font-md);
        color: var(--medium);
        border: 1px solid var(--stroke);
        border-radius: var(--mdl-shape-borderRadius-sm);
        padding: var(--mdl-spacing-2) var(--mdl-spacing-3) var(--mdl-spacing-2) var(--mdl-spacing-3);
    }

    .activity-description-availabilityinfo .core-module-availabilityinfo {
        background: var(--gray-300);
        font: var(--mdl-typography-label-font-lg);

        ::ng-deep ul {
            margin-top: 8px;
            margin-bottom: 0px;

            li {
                margin-bottom: 4px;
            }
        }
    }

    .core-module-loading {
        width: 100%;
        text-align: center;
        padding-top: 10px;
        clear: both;
    }

    .colored-box-with-icon {
        margin-top: var(--vertical-spacing);
        margin-bottom: var(--vertical-spacing);

        border: 0px;
        padding: var(--colored-box-padding);
        border-radius: var(--mdl-shape-borderRadius-sm);

        ion-icon {
            @include margin-horizontal(null, var(--mdl-spacing-2));
            margin-top: auto;
            margin-bottom: auto;
        }

        &.core-course-last-module-viewed {
            display: flex;
            background-color: #e0f2fe; // Light blue 100
            color: #0369a1; // Sky 700
            font-weight: 600;
            border-radius: 12px;
            margin: 0 16px 12px 16px; // Inset from card edges
            padding: 10px 12px;
            align-items: center;

            ion-icon {
                color: #0284c7; // Sky 600
                font-size: 16px;
            }
        }
    }

    @include media-breakpoint-down(md) {
        .core-module-buttons core-course-module-completion {
            display: none;
        }
    }

    @include media-breakpoint-up(md) {
        core-course-module-completion.activity-extra {
            display: none;
        }
    }

    &.indented ion-card {
        @include margin-horizontal(calc(var(--horizontal-spacing) + 1rem), null);
    }

    // Hide download folder icon meanwhile MOBILE-4147 is not solved
    core-format-text.core-module-description ::ng-deep .description-inner .navitem {
        display: none;
    }

}


:host-context(:root.dark) {
    ion-card {
        --ion-card-background: #2a2a2a !important;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2) !important;
    }

    .activity-main .activity-title .item-heading {
        color: #f3f4f6;
    }

    ion-button.button-outline {
        --border-color: #4b5563;
        --color: #e5e7eb;
    }

    .activity-description-availabilityinfo {
        .core-module-availabilityinfo {
            background: var(--gray-800);
        }
    }

    .colored-box-with-icon.core-course-last-module-viewed {
        background-color: rgba(3, 105, 161, 0.2); // Darker blue bg
        color: #7dd3fc; // Sky 300
        ion-icon { color: #38bdf8; }
    }
}
